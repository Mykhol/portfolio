---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
const sortedPosts = posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Base title="Blog" description="Thoughts and writing by Michael Howell">
  <h1 class="text-2xl font-bold tracking-tight mb-8">Blog</h1>
  {sortedPosts.length === 0 ? (
    <p class="text-neutral-500 italic">No posts yet.</p>
  ) : (
    <ul class="space-y-6">
      {sortedPosts.map((post) => (
        <li>
          <a href={`/blog/${post.id}`} class="group block">
            <p class="font-medium text-neutral-900 dark:text-neutral-100 group-hover:text-accent transition-colors">{post.data.title}</p>
            <p class="text-sm text-neutral-500 dark:text-neutral-400 mt-1">{post.data.summary}</p>
            <p class="text-xs text-neutral-500 dark:text-neutral-500 mt-1">{post.data.date.toLocaleDateString('en-NZ', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
          </a>
        </li>
      ))}
    </ul>
  )}
</Base>
